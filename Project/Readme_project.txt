Enhancement of image quality by registration of short exposure images

In this code I investigate an approach to computationally improve the quality and resolution of transmission electron microscopy images by combining information from  multiple short exposure images registered using intensity and spatial information.
The registration part of the code is from my colleague and has been already published.
The steps of the method are the following: 1. registration of the stack of images, 2.sharpening the stack of images, 3. aggregation of the stack of images.

In this project I would like to improve the quality of the rest of the code, make it faster and more organized.

Results:
You can find the time optimization in the file Time_optimization.docx

Additionaly I have created several modules, change the variable names and commented the whole code.